package com.betacom.car.process;

import java.util.List;
import com.betacom.car.exception.AcademyException;
import com.betacom.car.singletone.SQLConfiguration;

public class StartVeicolo {

    public boolean execute(String filePath) {
    	
        System.out.println("üöÄ Begin StartVeicolo");
        
        boolean rc = true;

        try {
            // Connessione al DB
            SQLConfiguration.getInstance().getConnection();
            SQLConfiguration.getInstance().setAutoCommit();
            System.out.println("\n‚úÖ Connessione aperta!\n");

            // Inizializzo il gestore file e leggo
            FileProcess fileProcessor = new FileProcess();
            List<String> comandi = fileProcessor.leggiFile(filePath);

            // Processo i comandi
            fileProcessor.processAddOnly(comandi);

        } catch (Exception e) {
            System.out.println("‚ùå Errore generale: " + e.getMessage());
            rc = false;
        }

        try {
            SQLConfiguration.getInstance().closeConnection();
            System.out.println("\nüîí Connessione chiusa!");
        } catch (AcademyException e) {
            System.out.println("‚ùå Errore chiusura connessione: " + e.getMessage());
        }

        return rc;
    }
}
